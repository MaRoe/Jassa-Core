<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Jassa-Core Source: facete/VarNode.js</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	
	<link type="text/css" rel="stylesheet" href="styles/site.simplex.css">
	
</head>

<body>
<div class="container-fluid">
	<div class="navbar navbar-fixed-top ">
		<div class="navbar-inner">
			<a class="brand" href="index.html">Jassa-Core</a>
			<ul class="nav">
				
				<li class="dropdown">
					<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="Cache.html">Cache</a>
						</li>
						
						<li>
							<a href="Cache.BasicCacheStorage.html">BasicCacheStorage</a>
						</li>
						
						<li>
							<a href="Cache.LocalStorageCacheStorage.html">LocalStorageCacheStorage</a>
						</li>
						

					</ul>
				</li>
				
			</ul>
		</div>
	</div>

	<div class="row-fluid">

		
			<div class="span12">
				
				<div id="main">
					


		<h1 class="page-title">Source: facete/VarNode.js</h1>
    
    <section>
        <article>
            <pre class="sunlight-highlight-javascript linenums">var forEach = require('lodash.foreach');

var Class = require('../ext/Class');

var VarNode = require('./VarNode');
var Step = require('./Step');

var HashMap = require('../util/collection/HashMap');
var ObjectUtils = require('../util/ObjectUtils');

/**
 * A class for generating variables for step-ids.
 * So this class does not care about the concrete step taken.
 *
 * @param variableName
 * @param generator
 * @param parent
 * @param root
 * @returns {ns.VarNode}
 */
var VarNode = Class.create({
    initialize: function(variableName, generator, step, parent, root) {
        this.variableName = variableName;
        this.generator = generator;
        //this.stepId = stepId; // Null for root
        this.step = step; // Null for root
        this.parent = parent;
        this.root = root;


        //console.log('VarNode status' , this);
        if(!this.root) {
            if(this.parent) {
                this.root = parent.root;
            }
            else {
                this.root = this;
            }
        }


        this.idToChild = new HashMap();
    },

    hashCode: function() {
        var result = ObjectUtils.hashCodeStr(this.variableName) * (this.step ? this.step.hashCode() : 7);
        return result;
    },

    equals: function(that) {
        throw new Error('Should not be called');
    },

    isRoot: function() {
        var result = this.parent ? false : true;
        return result;
    },

    /*
    getSourceVarName: function() {
        var result = this.root.variableName;
        return result;
    },
    */

    getVariableName: function() {
        return this.variableName;
    },

    /*
    forPath: function(path) {
        var steps = path.getSteps();

        var result;
        if(steps.length === 0) {
            result = this;
        } else {
            var step = steps[0];

            // TODO Allow steps back

            result = forStep(step);
        }

        return result;
    },
    */

//    getIdStr: function() {
//        var tmp = this.parent ? this.parent.getIdStr() : '';
//
//        var result = tmp + this.variableName;
//        return result;
//    },

    getStop: function(step) {
        return this.step;
    },

//    getStepId: function(step) {
//        return '' + JSON.stringify(step);
//    },

    getSteps: function() {
        return this.steps;
    },

    /**
     * Convenience method, uses forStep
     *
     * @param propertyUri
     * @param isInverse
     * @returns
     */
    forProperty: function(propertyUri, isInverse) {
        var step = new Step(propertyUri, isInverse);

        var result = this.forStep(step);

        return result;
    },

    forStep: function(step) {
        var child = this.idToChild.get(step);

        if(!child) {

            var subName = this.generator.next();
            child = new VarNode(subName, this.generator, step, this);

            //Unless we change something
            // we do not add the node to the parent
            this.idToChild.put(step, child);
        }

        return child;
    },

    /*
     * Recursively scans the tree, returning the first node
     * whose varName matches. Null if none found.
     *
     * TODO: Somehow cache the variable -> node mapping
     */
    findNodeByVarName: function(varName) {
        if(this.variableName === varName) {
            return this;
        }

        var children = [];
        forEach(this.idToChild, function(child) {
           children.push(child);
        });

        //var children = _.values(this.idToChild);
        //forEach(this.idToChild, function(child) {
        for(var i = 0; i &lt; children.length; ++i) {
            var child = children[i];

            var tmp = child.findNodeByVarName(varName);
            if(tmp) {
                return tmp;
            }
        }

        return null;
    }
});

module.exports = VarNode;
</pre>
        </article>
    </section>





				</div>

				<div class="clearfix"></div>
				<footer>
					
					AKSW
					<br />
					
					
		<span class="copyright">
		AKSW 2014
		</span>
					<br />
					
		<span class="jsdoc-message">
		Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha5</a>
		on Sun Apr 19 2015 19:44:26 GMT+0000 (UTC) using the <a href="https://github.com/terryweiss/docstrap">DocStrap template</a>.
		</span>
				</footer>
			</div>

			
			<br clear="both">
		</div>

	</div>
	<script src="scripts/sunlight.js"></script>
	<script src="scripts/sunlight.javascript.js"></script>
	<script src="scripts/sunlight-plugin.doclinks.js"></script>
	<script src="scripts/sunlight-plugin.linenumbers.js"></script>
	<script src="scripts/sunlight-plugin.menu.js"></script>
	<script src="scripts/jquery.min.js"></script>
	<script src="scripts/jquery.scrollTo.js"></script>
	<script src="scripts/jquery.localScroll.js"></script>
	<script src="scripts/bootstrap-dropdown.js"></script>
	<script src="scripts/toc.js"></script>


	<script>  Sunlight.highlightAll({lineNumbers:true,  showMenu: true, enableDoclinks :true}); </script>

	<script>
		$( function () {
			$( "#toc" ).toc( {
				selectors   : "h1,h2,h3,h4",
				showAndHide : false,
				scrollTo    : 60
			} );
			$( "#toc>ul" ).addClass( "nav nav-pills nav-stacked" );
			$( "#main span[id^='toc']" ).addClass( "toc-shim" );

		} );
	</script>

	

</body>
</html>
