<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Jassa-Core Source: facete/table/TableMod.js</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	
	<link type="text/css" rel="stylesheet" href="styles/site.simplex.css">
	
</head>

<body>
<div class="container-fluid">
	<div class="navbar navbar-fixed-top ">
		<div class="navbar-inner">
			<a class="brand" href="index.html">Jassa-Core</a>
			<ul class="nav">
				
				<li class="dropdown">
					<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="Cache.html">Cache</a>
						</li>
						
						<li>
							<a href="Cache.BasicCacheStorage.html">BasicCacheStorage</a>
						</li>
						
						<li>
							<a href="Cache.LocalStorageCacheStorage.html">LocalStorageCacheStorage</a>
						</li>
						

					</ul>
				</li>
				
			</ul>
		</div>
	</div>

	<div class="row-fluid">

		
			<div class="span12">
				
				<div id="main">
					


		<h1 class="page-title">Source: facete/table/TableMod.js</h1>
    
    <section>
        <article>
            <pre class="sunlight-highlight-javascript linenums">var Class = require('../../ext/Class');

var ArrayUtils = require('../../util/ArrayUtils');
var ColumnView = require('./ColumnView');

var HashMap = require('../../util/collection/HashMap');

/**
 * Object that holds configuration for modifications to a table.
 * Needs to be interpreted by another object.
 *
 * The purpose of this object is to mediate between table configurations
 * possible in a user interface and result set modifications on the
 * SPARQL level.
 *
 * { myCol1: {sortDir: 1, aggName: sum, path: foo}, ... }
 * - sum(?varForFoo) As myCol1
 *
 */
var TableMod = Class.create({
    initialize: function() {
        this.columnIds = []; // Array of active column ids

        this.colIdToColView = new HashMap(); // Ids can be objects, such as vars
        this.sortConditions = []; // Array of sortConditions, applied in order of their occurrence

        this.colIdToAgg = new HashMap();

        this.limit = null;
        this.offset = null;

        this._isDistinct = true;
    },

    getLimit: function() {
        return this.limit;
    },

    setLimit: function(limit) {
        this.limit = limit;
    },

    getOffset: function() {
        return this.offset;
    },

    setOffset: function(offset) {
        this.offset = offset;
    },

    isDistinct: function() {
        return this._isDistinct;
    },

    setDistinct: function(isDistinct) {
        this._isDistinct = isDistinct;
    },

    getColumnIds: function() {
        return this.columnIds;
    },

    getColumn: function(id) {
        return this.colIdToColView[id];
    },

    // Returns the active columns
    getColumns: function() {
        var self = this;
        var result = this.columnIds.map(function(columnId) {
            var r = self.colIdToColView[columnId];

            return r;
        });


        return result;
    },

    getSortConditions: function() {
        return this.sortConditions;
    },

    getLimitAndOffset: function() {
        return this.limitAndOffset;
    },

    getAggregator: function(columnId) {
        var result = this.colIdToAgg[columnId];
        return result;
    },

    getAggregators: function() {
        return this.colIdToAgg;
    },

    //setAggregator: function()

    /**
     * Adds a column based on a ColumnState object.
     *
     * @param suppressActive default: false; true: Do not add the id to the array of active columns
     */
    addColumn: function(columnId, suppressActive) {
        var colView = this.colIdToColView[columnId];
        if(colView) {
            throw new Error('Column ' + columnId + ' already part of the table');
        }

        colView = new ColumnView(this, columnId);
        this.colIdToColView[columnId] = colView;

        if(!suppressActive) {
            this.columnIds.push(columnId);
        }

        // TODO Fail on duplicate
        /*
        var columnId = columnState.getId();
        this.columnIds.push(columnId);

        this.idToState[columnId] = columnState;
        */

        return colView;
    },

    /**
     * Removes a column by id
     *
     * Also removes dependent objects, such as sort conditions and aggregations
     */
    removeColumn: function(columnId) {
        delete this.colIdToColView[columnId];

        var self = this;
        ArrayUtils.filter(this.columnIds, function(cid) {
            var r = columnId != cid;
            return r;
        });

        ArrayUtils.filter(this.sortConditions, function(sc) {
            var r = columnId != sc.getColumnId();
        });

        delete this.colIdToAgg[columnId];
    }
});

module.exports = TableMod;
</pre>
        </article>
    </section>





				</div>

				<div class="clearfix"></div>
				<footer>
					
					AKSW
					<br />
					
					
		<span class="copyright">
		AKSW 2014
		</span>
					<br />
					
		<span class="jsdoc-message">
		Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha5</a>
		on Sun Apr 19 2015 19:44:26 GMT+0000 (UTC) using the <a href="https://github.com/terryweiss/docstrap">DocStrap template</a>.
		</span>
				</footer>
			</div>

			
			<br clear="both">
		</div>

	</div>
	<script src="scripts/sunlight.js"></script>
	<script src="scripts/sunlight.javascript.js"></script>
	<script src="scripts/sunlight-plugin.doclinks.js"></script>
	<script src="scripts/sunlight-plugin.linenumbers.js"></script>
	<script src="scripts/sunlight-plugin.menu.js"></script>
	<script src="scripts/jquery.min.js"></script>
	<script src="scripts/jquery.scrollTo.js"></script>
	<script src="scripts/jquery.localScroll.js"></script>
	<script src="scripts/bootstrap-dropdown.js"></script>
	<script src="scripts/toc.js"></script>


	<script>  Sunlight.highlightAll({lineNumbers:true,  showMenu: true, enableDoclinks :true}); </script>

	<script>
		$( function () {
			$( "#toc" ).toc( {
				selectors   : "h1,h2,h3,h4",
				showAndHide : false,
				scrollTo    : 60
			} );
			$( "#toc>ul" ).addClass( "nav nav-pills nav-stacked" );
			$( "#main span[id^='toc']" ).addClass( "toc-shim" );

		} );
	</script>

	

</body>
</html>
